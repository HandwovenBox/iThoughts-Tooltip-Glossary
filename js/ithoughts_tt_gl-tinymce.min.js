/**
 * @file TinyMCE plugin scripts
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license http://www.gnu.org/licenses/old-licenses/gpl-2.0.fr.html GPLv2
 * @package ithoughts-tooltip-glossary
 *
 * @version 2.5.0
 */
!function(t){"use strict";function e(t,e){return function(){var o=this;e.on(t,function(t){o.active(t.active)})}}var o=t.$,n=ithoughts_tt_gl,i=ithoughts_tt_gl_editor,s="ithoughts_tt_gl",r=s+"_tinymce",a="ithoughts-tooltip-glossary",l=(n.stripQuotes,t.isNA,["ithoughts-tooltip-glossary-term","ithoughts-tooltip-glossary-tooltip","ithoughts-tooltip-glossary-mediatip"]),c=l.map(function(t){return'[data-type="'+t+'"]'}).join(",");tinymce.PluginManager.add(r,function(t,n){function l(e){var n=t.selection.getNode(),i=o(n),s=i.closest(c),r=s.get(0);if(r){var a=r.innerHTML;s.replaceWith(a)}}function g(){var e=t.selection,n={DOM:o(e.getNode()).closest(c).toArray()};return n.html=e.getContent({format:"html"}),n.start=e.getStart(),n.end=e.getEnd(),n}function d(e,o){"load"===o?t.selection.select(t.selection.getStart()):o.indexOf("extend")>-1&&i.error('Unhandled mode "extend" during writing of new tooltip shortcode'),t.insertContent(e)}t.contentCSS.push(n+"/../css/"+s+"-admin.css?v=2.1.7"),t.on("BeforeSetcontent",function(t){t.content=i.replaceShortcodes(t.content)}).on("GetContent",function(t){t.content=i.restoreShortcodes(t.content)}).on("NodeChange",function(e){var n=e.element;o(n).closest(c).length>0?(t.fire("glossaryterm",{active:!0}),t.fire("glossaryterm-d",{active:!0})):(t.fire("glossaryterm",{active:!1}),t.fire("glossaryterm-d",{active:!1})),-1!==[a+"-term_list",a+"-atoz"].indexOf(n.getAttribute("data-type"))?t.fire("glossarylist",{active:!0}):t.fire("glossarylist",{active:!1})}),t.addButton("glossaryterm",{title:t.getLang(r+".add_tooltip"),image:n+"/icon/glossaryterm.png",onPostRender:e("glossaryterm",t),onclick:function(){i.editorForms.tip(g(),d)}}),t.addButton("glossaryterm-d",{title:t.getLang(r+".remove_tooltip"),image:n+"/icon/glossaryterm-d.png",onPostRender:e("glossaryterm-d",t),onclick:l});t.addButton("glossarylist",{title:t.getLang(r+".add_index"),image:n+"/icon/glossaryindex.png",onPostRender:e("glossarylist",t),onclick:function(){var e={selection:t.selection};e.start=e.selection.getStart(),e.end=e.selection.getEnd(),e.DOM=o.parseHTML(e.selection),i.editorForms.list(g(),d)}})})}(Ithoughts.v4);