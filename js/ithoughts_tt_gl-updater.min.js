/*! ithoughts-tooltip-glossary build on 2017-04-22 01:08:57 for v2.7.0 */
/**
 * @file Handles the dialog logic between server updates operations and client
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPLv3
 * @package ithoughts-tooltip-glossary
 *
 * @version 2.7.0
 */
ithoughts_tt_gl=ithoughts_tt_gl||{},function(a){function b(a){h.post(ithoughts_tt_gl.admin_ajax,{action:"ithoughts_tt_gl_update",data:{versions:Updater,progression:a,maxAdvandement:f.max}},function(a){g.parentElement.scrollTop>g.parentElement.scrollHeight-g.parentElement.clientHeight-50&&(g.parentElement.scrollTop=g.parentElement.scrollHeight);var i=g.parentElement.scrollHeight-g.parentElement.clientHeight;if(d.value=a.data.progression,e.innerHTML=d.value+"/"+f.max+" (<em>"+(parseInt(d.value/f.max*100)+"").slice(0,3)+"%</em>)",a.data.verbose)for(var j=0,k=a.data.verbose.length;j<k;j++)h(g).append(h.parseHTML('<p class="'+a.data.verbose[j].type+'">'+a.data.verbose[j].text+"</p>"));g.parentElement.scrollTop>i-50&&(g.parentElement.scrollTop=g.parentElement.scrollHeight),a.data.progression<f.max?b(a.data.progression):(Updater.from=f.targetversion,jQuery.post(ithoughts_tt_gl.admin_ajax,{action:"ithoughts_tt_gl_update_done",data:{newversion:Updater.from}},function(a){a.success&&c(Updater)}))})}function c(a){h.post(ithoughts_tt_gl.admin_ajax,{action:"ithoughts_tt_gl_update",data:{versions:a,progression:-1,maxAdvandement:-1}},function(a){var c=h("#Updater");if(g='<div class="verboseContainer postbox closed"><div class="handlediv" title="Cliquer pour inverser."></div><h4 class="hndle ui-sortable-handle">Logs</h4><div class="inside"><pre class="verboseArea">',a.data.verbose)for(var i=0,j=a.data.verbose.length;i<j;i++)g+='<p class="'+a.data.verbose[i].type+'">'+a.data.verbose[i].text+"</p>";g+="</pre></div></div>",postboxes.add_postbox_toggles(pagenow),a.data.Ended?(c.append(h.parseHTML('<article data-version="ended"><h3>'+a.data.title+'</h3><p class="updatedescription">'+a.data.text+"</p></article>")),postboxes.add_postbox_toggles(pagenow)):(c.append(h.parseHTML('<article data-version="'+a.data.targetversion+'"><h3>V'+a.data.targetversion+'</h3><p class="updatedescription">'+a.data.text+'</p><progress class="updateprogress" min="0" max="'+a.data.max+'" value="0"></progress><span class="updateprogresstext">0/'+a.data.max+" (<em>0%</em>)</span>"+g+"</article>")),postboxes.add_postbox_toggles(pagenow),f=a.data,d=qs('[data-version="" + out.data.targetversion + ""] .updateprogress'),e=qs('[data-version="" + out.data.targetversion + ""] .updateprogresstext'),g=qs('[data-version="" + out.data.targetversion + ""] .verboseArea'),b(0))})}var d,e,f,g,h=a.$;c(Updater)}(Ithoughts.v4);/**/