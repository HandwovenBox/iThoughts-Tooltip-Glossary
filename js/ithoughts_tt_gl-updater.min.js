/*! ithoughts-tooltip-glossary build on 2017-04-22 09:35:44 for v2.7.0 */
/**
 * @file Handles the dialog logic between server updates operations and client
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPLv3
 * @package ithoughts-tooltip-glossary
 *
 * @version 2.7.0
 */
!function(){function a(g){$.post(ithoughts_tt_gl.admin_ajax,{action:"ithoughts_tt_gl_update",data:{versions:Updater,progression:g,maxAdvandement:e.max}},function(g){f.parentElement.scrollTop>f.parentElement.scrollHeight-f.parentElement.clientHeight-50&&(f.parentElement.scrollTop=f.parentElement.scrollHeight);var h=f.parentElement.scrollHeight-f.parentElement.clientHeight;if(c.value=g.data.progression,d.innerHTML=c.value+"/"+e.max+" (<em>"+(parseInt(c.value/e.max*100)+"").slice(0,3)+"%</em>)",g.data.verbose)for(var i=0,j=g.data.verbose.length;i<j;i++)$(f).append($.parseHTML('<p class="'+g.data.verbose[i].type+'">'+g.data.verbose[i].text+"</p>"));f.parentElement.scrollTop>h-50&&(f.parentElement.scrollTop=f.parentElement.scrollHeight),g.data.progression<e.max?a(g.data.progression):(Updater.from=e.targetversion,jQuery.post(ithoughts_tt_gl.admin_ajax,{action:"ithoughts_tt_gl_update_done",data:{newversion:Updater.from}},function(a){a.success&&b(Updater)}))})}function b(b){$.post(ithoughts_tt_gl.admin_ajax,{action:"ithoughts_tt_gl_update",data:{versions:b,progression:-1,maxAdvandement:-1}},function(b){var g=$("#Updater");if(f='<div class="verboseContainer postbox closed"><div class="handlediv" title="Cliquer pour inverser."></div><h4 class="hndle ui-sortable-handle">Logs</h4><div class="inside"><pre class="verboseArea">',b.data.verbose)for(var h=0,i=b.data.verbose.length;h<i;h++)f+='<p class="'+b.data.verbose[h].type+'">'+b.data.verbose[h].text+"</p>";f+="</pre></div></div>",postboxes.add_postbox_toggles(pagenow),b.data.Ended?(g.append($.parseHTML('<article data-version="ended"><h3>'+b.data.title+'</h3><p class="updatedescription">'+b.data.text+"</p></article>")),postboxes.add_postbox_toggles(pagenow)):(g.append($.parseHTML('<article data-version="'+b.data.targetversion+'"><h3>V'+b.data.targetversion+'</h3><p class="updatedescription">'+b.data.text+'</p><progress class="updateprogress" min="0" max="'+b.data.max+'" value="0"></progress><span class="updateprogresstext">0/'+b.data.max+" (<em>0%</em>)</span>"+f+"</article>")),postboxes.add_postbox_toggles(pagenow),e=b.data,c=qs('[data-version="'+b.data.targetversion+'"] .updateprogress'),d=qs('[data-version="'+b.data.targetversion+'"] .updateprogresstext'),f=qs('[data-version="'+b.data.targetversion+'"] .verboseArea'),a(0))})}var c,d,e,f;b(Updater)}();/**/