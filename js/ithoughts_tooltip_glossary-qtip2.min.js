/**
 * @file Interface between plugin formatted data and qTip API
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license http://www.gnu.org/licenses/old-licenses/gpl-2.0.fr.html GPLv2
 * @package ithoughts-tooltip-glossary
 *
 * @version 2.5.0
 */
function stripQuotes(t,e){return"string"!=typeof t?"":e?t.replace(/"/g,"&aquot;").replace(/\n/g,"<br/>"):t.replace(/<br\/>/g,"\n").replace(/&aquot;/g,'"')}!function(){function t(t){var e=$(document.createElement("div"));$(e).append($(t));var e=e.html();return e}function e(e){for(var i=$w.height(),o=$w.width(),s=0,a=[[512,288],[256,144]],n=a.length;n>s&&!(o>a[s][0]&&i>a[s][1]);s++);s=Math.min(a.length,Math.max(0,s));var r=a[s];return"undefined"!=typeof e||"undefined"==typeof r?(e.prop({width:r[0],height:r[1]}).addClass("ithoughts_tt_gl-video"),{dims:{width:r[0],height:r[1]},text:t(e)}):($(".ithoughts_tt_gl-video").prop({width:r[0],height:r[1]}),void $(".ithoughts_tt_gl-video_tip").each(function(){var t=$(this).qtip("api"),e=t.disabled;t.enable(),t.reposition(),t.disable(e)}).css({width:r[0],height:r[1]}))}var i,o=navigator.userAgent.match(/(iPad|iPhone|iPod)/g),s=o||navigator.userAgent.match(/(Android|webOS|BlackBerry)/i)?1:0;$w.resize(function(){clearTimeout(i),i=setTimeout(e,100)}),$d.ready(function(){tooltipsContainer=$($.parseHTML('<div id="ithoughts_tooltip_glossary-tipsContainer"></div>')),$(document.body).append(tooltipsContainer);var t={start:o?"mousedown":"touchstart",end:o?"mouseup":"touchend"};o&&$("body").css({cursor:"pointer"}),$("span[class^=ithoughts_tooltip_glossary-]").each(function(){var i=$(this).data("qtipstyle")?$(this).data("qtipstyle"):ithoughts_tt_gl.qtipstyle,o=$(this).data("termcontent")?$(this).data("termcontent"):ithoughts_tt_gl.termcontent,a=$(this).data("qtipshadown")?$(this).data("qtipshadown"):ithoughts_tt_gl.qtipshadown;a="true"===a||"1"===a;var n=$(this).data("qtiprounded")?$(this).data("qtiprounded"):ithoughts_tt_gl.qtiprounded;n="true"===n||"1"===n;var r=$(this).data("qtiptrigger")?$(this).data("qtiptrigger"):ithoughts_tt_gl.qtiptrigger;if("click"==r){var h=$(this);h.children("a").click(function(t){1!=h.touch&&(t.preventDefault(),h.touch=1)}).mouseleave(function(){h.touch=0})}else if("responsive"==r){var h=$(this);h.touch=s,$("body").bind("click touch",function(t){0==$(t.target).closest(h).length&&(h.data("expanded",!1),h.triggerHandler("responsiveout"))}),h.children("a").click(function(t){h.data("expanded")||0==h.touch||(h.data("expanded",!0),h.triggerHandler("responsive"),t.preventDefault())}).bind(t.start,function(t){h.touch=1}).bind(t.end,function(t){h.touch=2}).bind("mouseover focus",function(t){h.triggerHandler("responsive")}).bind("mouseleave focusout",function(t){h.triggerHandler("responsiveout")})}var l;l=this.getAttribute("data-tooltip-theme")?"qtip-"+this.getAttribute("data-tooltip-theme")+(a?" qtip-shadow":"")+(n?" qtip-rounded":"")+" ":this.getAttribute("data-tooltip-classes")?this.getAttribute("data-tooltip-classes"):"qtip-"+i+(a?" qtip-shadow":"")+(n?" qtip-rounded":"")+" ";var d;if($(this).hasClass("ithoughts_tooltip_glossary-glossary"))if(this.getAttribute("data-termid")&&"off"!=o){var u={action:"ithoughts_tt_gl_get_term_details",content:o,termid:$(this).data().termid};"true"==this.getAttribute("data-disable_auto_translation")&&(u.disable_auto_translation=!0),d={content:{text:ithoughts_tt_gl.lang.qtip.pleasewait_ajaxload.content,ajax:{url:ithoughts_tt_gl.admin_ajax,type:"POST",data:u,dataType:"json",loading:!1,success:function(t,e){t.success?(this.set("content.title",t.data.title),this.set("content.text",t.data.content)):this.set("content.text","Error")}},title:{text:ithoughts_tt_gl.lang.qtip.pleasewait_ajaxload.title}},style:{classes:l+"ithoughts_tooltip_glossary-glossary"}}}else this.getAttribute("data-term-content")&&this.getAttribute("data-term-title")&&(d={content:{title:{text:this.getAttribute("data-term-title")},text:this.getAttribute("data-term-content")},style:{classes:l+"ithoughts_tooltip_glossary-glossary"}});else if($(this).hasClass("ithoughts_tooltip_glossary-tooltip"))console.log(stripQuotes(this.getAttribute("data-tooltip-content"),!1)),d={style:{classes:l+"ithoughts_tooltip_glossary-tooltip"},content:{text:stripQuotes(this.getAttribute("data-tooltip-content"),!1),title:{text:$(this).text()}}};else{if(!$(this).hasClass("ithoughts_tooltip_glossary-mediatip"))return;if(d={style:{classes:l+"ithoughts_tooltip_glossary-mediatip"},position:{adjust:{scroll:!1}},content:{text:"",title:{text:$(this).text()}},hide:{fixed:!0,delay:100},events:{show:function(){$(this).qtip().reposition()}}},this.getAttribute("data-mediatip-image")){var g={src:this.getAttribute("data-mediatip-image"),alt:$(this).text()};if("undefined"!=typeof ithoughts_tt_gl.qtip_filters&&ithoughts_tt_gl.qtip_filters&&"undefined"!=typeof ithoughts_tt_gl.qtip_filters.mediatip&&ithoughts_tt_gl.qtip_filters.mediatip&&ithoughts_tt_gl.qtip_filters.mediatip.length>0)for(var p=0;p<ithoughts_tt_gl.qtip_filters.mediatip.length;p++)g=$.extend(g,ithoughts_tt_gl.qtip_filters.mediatip[p]($(this)));var c="";for(var _ in g)c+=_+'="'+g[_]+'" ';d.content.text="<img "+c+">";var f=this.getAttribute("data-mediatip-caption");f&&(d.content.text+='<div class="ithoughts_tt_gl-caption">'+f.replace(/&aquot;/g,'"')+"</div>")}else if(this.getAttribute("data-mediatip-html")){var m=function(t){return 1==t.length&&("IFRAME"==t[0].nodeName&&t[0].src.match(/youtube|dailymotion/)||"VIDEO"==t[0].nodeName)?e(t):void 0}($($.parseHTML(this.getAttribute("data-mediatip-html").replace("&quot;",'"').trim())));d.content.text=m.text,d.content.title.text='<span class="ithoughts_tooltip_glossary_pin_container"><svg viewBox="0 0 26 26" class="ithoughts_tooltip_glossary_pin"><use xlink:href="#icon-pin"></use></svg></span><span class="ithoughts_tt_gl-title_with_pin">'+d.content.title.text+"</span>",d.style.classes+=" ithoughts_tt_gl-force_no_pad ithoughts_tt_gl-video_tip ithoughts_tt_gl-with_pin",d.style.width=m.dims.width,d.events.render=function(t,e){e.elements.title.find(".ithoughts_tooltip_glossary_pin_container").click(function(){$(this).toggleClass("pined"),$(this).hasClass("pined")?e.disable():e.enable()})}}}"true"==this.getAttribute("data-tooltip-autoshow")&&(d.show=$.extend(!0,d.show,{ready:!0})),"true"==this.getAttribute("data-tooltip-nosolo")&&(d.show=$.extend(!0,d.show,{solo:!1})),"true"==this.getAttribute("data-tooltip-nohide")&&(d=$.extend(!0,d,{hide:"someevent",show:{event:"someevent"}})),this.getAttribute("data-tooltip-id")&&(d=$.extend(!0,d,{id:this.getAttribute("data-tooltip-id")}));var v=$.extend(!0,{prerender:!0,position:{at:"top center",my:"bottom center",viewport:$("body"),effect:!1,container:tooltipsContainer},show:{event:r,solo:!0},hide:"responsive"==r?"responsiveout":"mouseleave",style:l},d);$(this).qtip(v),$(this).find("a[title]").removeAttr("title")})})}();