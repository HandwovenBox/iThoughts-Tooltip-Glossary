<!DOCTYPE html>

<html>
<head>
  <title>ithoughts_tt_gl-editor.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="ithoughts_tt_gl-admin.html">
                  ithoughts_tt_gl-admin.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-atoz.html">
                  ithoughts_tt_gl-atoz.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-editor.html">
                  ithoughts_tt_gl-editor.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-floater.html">
                  ithoughts_tt_gl-floater.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-qtip2.html">
                  ithoughts_tt_gl-qtip2.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-styleeditor.html">
                  ithoughts_tt_gl-styleeditor.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-tinymce-forms.html">
                  ithoughts_tt_gl-tinymce-forms.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-tinymce.html">
                  ithoughts_tt_gl-tinymce.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-updater.html">
                  ithoughts_tt_gl-updater.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-admin.html">
                  ithoughts_tt_gl-admin.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-atoz.html">
                  ithoughts_tt_gl-atoz.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-editor.html">
                  ithoughts_tt_gl-editor.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-floater.html">
                  ithoughts_tt_gl-floater.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-qtip2.html">
                  ithoughts_tt_gl-qtip2.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-styleeditor.html">
                  ithoughts_tt_gl-styleeditor.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-tinymce-forms.html">
                  ithoughts_tt_gl-tinymce-forms.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-tinymce.html">
                  ithoughts_tt_gl-tinymce.js
                </a>
              
                
                <a class="source" href="ithoughts_tt_gl-updater.html">
                  ithoughts_tt_gl-updater.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>ithoughts_tt_gl-editor.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @file Script loaded as soon a post editor is opened. It contains all basic functions to insert shortcodes
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPLv3
 * @package ithoughts-tooltip-glossary
 *
 * @version 2.7.0
 */</span>

<span class="hljs-comment">/*global QTags: false, iThoughtsTooltipGlossaryEditor: false */</span>
<span class="hljs-meta">
'use strict'</span>;

<span class="hljs-comment">/**
 * @function initTinyMCEPlugin
 * @description Namespace &amp; register both term &amp; list TinyMCE plugins for iThoughts Tooltip Glossary
 * @param {Object} ithoughts Appropriate version of iThoughts Tooltip Glossary helper
 */</span>
( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initTinyMCEPlugin</span>(<span class="hljs-params"> ithoughts </span>) </span>{
	ithoughts.$d.ready( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onDocumentReady</span>(<span class="hljs-params"></span>) </span>{
		<span class="hljs-keyword">var</span> $    			= ithoughts.$,
			itg				= iThoughtsTooltipGlossary,
			itge			= iThoughtsTooltipGlossaryEditor,
			stripQuotes		= itg.stripQuotes,
			prefix3			= <span class="hljs-string">'ithoughts-tooltip-glossary'</span>,
			prefix4			= <span class="hljs-string">'itg'</span>,
			tipsTypes		= [ <span class="hljs-string">'ithoughts-tooltip-glossary-term'</span>, <span class="hljs-string">'ithoughts-tooltip-glossary-tooltip'</span>, <span class="hljs-string">'ithoughts-tooltip-glossary-mediatip'</span> ],
			htmlAttrs		= [ <span class="hljs-string">'href'</span> ],
			isNA			= ithoughts.isNA;

		ithoughts.initLoggers( itge, <span class="hljs-string">'iThoughts Tooltip Glossary'</span>, itge.verbosity );
		itge.removeAccents = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeAccents</span>(<span class="hljs-params"> s </span>) </span>{
			<span class="hljs-keyword">var</span> translateRegex	= <span class="hljs-regexp">/[¹²³áàâãäåaaaÀÁÂÃÄÅAAAÆccç©CCÇÐÐèéê?ëeeeeeÈÊË?EEEEE€gGiìíîïìiiiÌÍÎÏ?ÌIIIlLnnñNNÑòóôõöoooøÒÓÔÕÖOOOØŒr®Ršs?ßŠS?ùúûüuuuuÙÚÛÜUUUUýÿÝŸžzzŽZZ]/g</span>,
				translate		= {
					<span class="hljs-string">'¹'</span>: <span class="hljs-string">'1'</span>,
					<span class="hljs-string">'²'</span>: <span class="hljs-string">'2'</span>,
					<span class="hljs-string">'³'</span>: <span class="hljs-string">'3'</span>,
					<span class="hljs-string">'á'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'à'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'â'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'ã'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'ä'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'å'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-attr">a</span>:   <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'À'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'Á'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'Â'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'Ã'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'Ä'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'Å'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-attr">A</span>:   <span class="hljs-string">'a'</span>,
					<span class="hljs-string">'Æ'</span>: <span class="hljs-string">'a'</span>,
					<span class="hljs-attr">c</span>:   <span class="hljs-string">'c'</span>,
					<span class="hljs-string">'ç'</span>: <span class="hljs-string">'c'</span>,
					<span class="hljs-string">'©'</span>: <span class="hljs-string">'c'</span>,
					<span class="hljs-attr">C</span>:   <span class="hljs-string">'c'</span>,
					<span class="hljs-string">'Ç'</span>: <span class="hljs-string">'c'</span>,
					<span class="hljs-string">'Ð'</span>: <span class="hljs-string">'d'</span>,
					<span class="hljs-string">'è'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'é'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'ê'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'?'</span>: <span class="hljs-string">'s'</span>,
					<span class="hljs-string">'ë'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-attr">e</span>:   <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'È'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'Ê'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'Ë'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-attr">E</span>:   <span class="hljs-string">'e'</span>,
					<span class="hljs-string">'€'</span>: <span class="hljs-string">'e'</span>,
					<span class="hljs-attr">g</span>:   <span class="hljs-string">'g'</span>,
					<span class="hljs-attr">G</span>:   <span class="hljs-string">'g'</span>,
					<span class="hljs-attr">i</span>:   <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'ì'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'í'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'î'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'ï'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'Ì'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'Í'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'Î'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-string">'Ï'</span>: <span class="hljs-string">'i'</span>,
					<span class="hljs-attr">I</span>:   <span class="hljs-string">'i'</span>,
					<span class="hljs-attr">l</span>:   <span class="hljs-string">'l'</span>,
					<span class="hljs-attr">L</span>:   <span class="hljs-string">'l'</span>,
					<span class="hljs-attr">n</span>:   <span class="hljs-string">'n'</span>,
					<span class="hljs-string">'ñ'</span>: <span class="hljs-string">'n'</span>,
					<span class="hljs-attr">N</span>:   <span class="hljs-string">'n'</span>,
					<span class="hljs-string">'Ñ'</span>: <span class="hljs-string">'n'</span>,
					<span class="hljs-string">'ò'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'ó'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'ô'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'õ'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'ö'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-attr">o</span>:   <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'ø'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Ò'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Ó'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Ô'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Õ'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Ö'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-attr">O</span>:   <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Ø'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-string">'Œ'</span>: <span class="hljs-string">'o'</span>,
					<span class="hljs-attr">r</span>:   <span class="hljs-string">'r'</span>,
					<span class="hljs-string">'®'</span>: <span class="hljs-string">'r'</span>,
					<span class="hljs-attr">R</span>:   <span class="hljs-string">'r'</span>,
					<span class="hljs-string">'š'</span>: <span class="hljs-string">'s'</span>,
					<span class="hljs-attr">s</span>:   <span class="hljs-string">'s'</span>,
					<span class="hljs-string">'ß'</span>: <span class="hljs-string">'s'</span>,
					<span class="hljs-string">'Š'</span>: <span class="hljs-string">'s'</span>,
					<span class="hljs-attr">S</span>:   <span class="hljs-string">'s'</span>,
					<span class="hljs-string">'ù'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'ú'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'û'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'ü'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-attr">u</span>:   <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'Ù'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'Ú'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'Û'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'Ü'</span>: <span class="hljs-string">'u'</span>,
					<span class="hljs-attr">U</span>:   <span class="hljs-string">'u'</span>,
					<span class="hljs-string">'ý'</span>: <span class="hljs-string">'y'</span>,
					<span class="hljs-string">'ÿ'</span>: <span class="hljs-string">'y'</span>,
					<span class="hljs-string">'Ý'</span>: <span class="hljs-string">'y'</span>,
					<span class="hljs-string">'Ÿ'</span>: <span class="hljs-string">'y'</span>,
					<span class="hljs-string">'ž'</span>: <span class="hljs-string">'z'</span>,
					<span class="hljs-attr">z</span>:   <span class="hljs-string">'z'</span>,
					<span class="hljs-string">'Ž'</span>: <span class="hljs-string">'z'</span>,
					<span class="hljs-attr">Z</span>:   <span class="hljs-string">'z'</span>,
				};
			<span class="hljs-keyword">return</span> s.replace( translateRegex, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doReplace</span>(<span class="hljs-params"> match </span>) </span>{
				<span class="hljs-keyword">return</span> translate[match];
			});
		};

		itge.replaceShortcodes = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceShortcodes</span>(<span class="hljs-params"> content </span>) </span>{
			<span class="hljs-keyword">var</span> repLength = itge.replaceShortcodesEl.length,
				i = <span class="hljs-number">-1</span>;
			<span class="hljs-keyword">while</span> (( i += <span class="hljs-number">1</span> ) &lt; repLength ) {
				content = itge.replaceShortcodesEl[i]( content );
			}
			<span class="hljs-keyword">return</span> content;
		};
		itge.restoreShortcodes = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">restoreShortcodes</span>(<span class="hljs-params"> content </span>) </span>{
			<span class="hljs-keyword">var</span> resLength = itge.restoreShortcodesEl.length,
				i = <span class="hljs-number">-1</span>;
			<span class="hljs-keyword">while</span> (( i += <span class="hljs-number">1</span> ) &lt; resLength ) {
				content = itge.restoreShortcodesEl[i]( content );
			}
			<span class="hljs-keyword">return</span> content;
		};
		itge.replaceShortcodesEl = [
			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceShortcodeElGlossary</span>(<span class="hljs-params"> content </span>) </span>{ <span class="hljs-comment">// For [glossary]</span>
				<span class="hljs-keyword">return</span> content.replace( <span class="hljs-regexp">/\[(?:itg-)?(glossary|tooltip|mediatip)(?!_)(.*?)\](.*?)\[\/(?:itg-)?(glossary|tooltip|mediatip)\]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doReplace</span>(<span class="hljs-params"> all, balise, inner, text </span>) </span>{
					<span class="hljs-keyword">var</span> attrs	= {},
						regex	= <span class="hljs-regexp">/([\w\d\-]+?)="(.+?)"/g</span>,
						matched	= <span class="hljs-literal">null</span>,
						ret		= <span class="hljs-string">`&lt;a data-type="<span class="hljs-subst">${  prefix3  }</span>-<span class="hljs-subst">${  {
							glossary: <span class="hljs-string">'term'</span>,
							tooltip:  <span class="hljs-string">'tooltip'</span>,
							mediatip: <span class="hljs-string">'mediatip'</span>,
						}</span>[balise]  }"`</span>,
						i;
					<span class="hljs-keyword">while</span> ( <span class="hljs-literal">true</span> === <span class="hljs-built_in">Boolean</span>( matched = regex.exec( inner ))) {
						attrs[matched[<span class="hljs-number">1</span>]] = matched[<span class="hljs-number">2</span>];
					}
					<span class="hljs-keyword">for</span> ( i <span class="hljs-keyword">in</span> attrs ) {
						<span class="hljs-keyword">if</span> ( attrs.hasOwnProperty( i )) {
							<span class="hljs-keyword">if</span> ( htmlAttrs.indexOf( i ) &gt; <span class="hljs-number">-1</span> || <span class="hljs-number">0</span> === i.indexOf( <span class="hljs-string">'data-'</span> )) {
								ret += <span class="hljs-string">` <span class="hljs-subst">${  i  }</span>="<span class="hljs-subst">${  attrs[i]  }</span>"`</span>;
							} <span class="hljs-keyword">else</span> {
								ret += <span class="hljs-string">` data-<span class="hljs-subst">${  i  }</span>="<span class="hljs-subst">${  attrs[i]  }</span>"`</span>;
							}
						}
					}
					<span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${ ret  }</span>&gt;<span class="hljs-subst">${  text  }</span>&lt;/a&gt;`</span>;
				});
			},
			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceShortcodeElList</span>(<span class="hljs-params"> content </span>) </span>{ <span class="hljs-comment">// For [glossary_(term_list|atoz)]</span>
				<span class="hljs-keyword">return</span> content.replace( <span class="hljs-regexp">/\[glossary_(term_list|atoz)(.*?)\/\]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doReplace</span>(<span class="hljs-params"> all, type, attrStr </span>) </span>{
					<span class="hljs-keyword">var</span> attrs	= {},
						regex	= <span class="hljs-regexp">/([\w\d\-]+?)="(.+?)"/g</span>,
						matched	= <span class="hljs-literal">null</span>,
						ret		= <span class="hljs-string">`&lt;span data-type="<span class="hljs-subst">${  prefix3  }</span>-<span class="hljs-subst">${  type  }</span>"`</span>,
						i;
					<span class="hljs-keyword">while</span> ( <span class="hljs-literal">true</span> === <span class="hljs-built_in">Boolean</span>( matched = regex.exec( attrStr ))) {
						attrs[matched[<span class="hljs-number">1</span>]] = matched[<span class="hljs-number">2</span>];
					}
					<span class="hljs-keyword">for</span> ( i <span class="hljs-keyword">in</span> attrs ) {
						<span class="hljs-keyword">if</span> ( attrs.hasOwnProperty( i )) {
							<span class="hljs-keyword">if</span> ( htmlAttrs.indexOf( i ) &gt; <span class="hljs-number">-1</span> || <span class="hljs-number">0</span> === i.indexOf( <span class="hljs-string">'data-'</span> )) {
								ret += <span class="hljs-string">` <span class="hljs-subst">${  i  }</span>="<span class="hljs-subst">${  attrs[i]  }</span>"`</span>;
							} <span class="hljs-keyword">else</span> {
								ret += <span class="hljs-string">` data-<span class="hljs-subst">${  i  }</span>="<span class="hljs-subst">${  attrs[i]  }</span>"`</span>;
							}
						}
					}
					<span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${ ret  }</span>&gt;Glossary <span class="hljs-subst">${  ( <span class="hljs-string">'term_list'</span> === type ) ? <span class="hljs-string">'List'</span> : <span class="hljs-string">'A-to-Z'</span>  }</span>&lt;/span&gt;`</span>;
				});
			},
		];
		itge.restoreShortcodesEl = [
			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">restoreShortcodeElGlossary</span>(<span class="hljs-params"> content </span>) </span>{ <span class="hljs-comment">// For [glossary]</span>
				<span class="hljs-keyword">return</span> content.replace( <span class="hljs-regexp">/&lt;a\s+(?=[^&gt;]*data-type="ithoughts-tooltip-glossary-(term|tooltip|mediatip)")(.*?)&gt;(.*?)&lt;\/a&gt;/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doReplace</span>(<span class="hljs-params"> all, type, inner, text </span>) </span>{
					<span class="hljs-keyword">var</span> attrs	= {},
						regex	= <span class="hljs-regexp">/(data-)?([\w\d\-]+?)="(.+?)"/g</span>,
						matched	= <span class="hljs-literal">null</span>,
						b		= {
							<span class="hljs-attr">term</span>:     <span class="hljs-string">'glossary'</span>,
							<span class="hljs-attr">tooltip</span>:  <span class="hljs-string">'tooltip'</span>,
							<span class="hljs-attr">mediatip</span>: <span class="hljs-string">'mediatip'</span>,
						}[type],
						ret		= <span class="hljs-string">`[<span class="hljs-subst">${  prefix4  }</span>-<span class="hljs-subst">${  b }</span>`</span>,
						i;
					<span class="hljs-keyword">while</span> ( <span class="hljs-literal">true</span> === <span class="hljs-built_in">Boolean</span>( matched = regex.exec( inner ))) {
						<span class="hljs-keyword">if</span> ( matched[<span class="hljs-number">1</span>] !== <span class="hljs-string">'data-'</span> || matched[<span class="hljs-number">2</span>] !== <span class="hljs-string">'type'</span> ) {
							<span class="hljs-keyword">if</span> ( htmlAttrs.indexOf( matched[<span class="hljs-number">2</span>]) &gt; <span class="hljs-number">-1</span> &amp;&amp; <span class="hljs-keyword">typeof</span> matched[<span class="hljs-number">1</span>] !== <span class="hljs-string">'undefined'</span> ) {
								attrs[matched[<span class="hljs-number">1</span>] + matched[<span class="hljs-number">2</span>]] = matched[<span class="hljs-number">3</span>];
							} <span class="hljs-keyword">else</span> {
								attrs[matched[<span class="hljs-number">2</span>]] = matched[<span class="hljs-number">3</span>];
							}
						}
					}
					<span class="hljs-keyword">for</span> ( i <span class="hljs-keyword">in</span> attrs ) {
						<span class="hljs-keyword">if</span> ( attrs.hasOwnProperty( i )) {
							ret += <span class="hljs-string">` <span class="hljs-subst">${  i  }</span>="<span class="hljs-subst">${  attrs[i]  }</span>"`</span>;
						}
					}
					<span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${ ret  }</span>]<span class="hljs-subst">${  text  }</span>[/<span class="hljs-subst">${  prefix4  }</span>-<span class="hljs-subst">${  b  }</span>]`</span>;
				});
			},
			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">restoreShortcodeElList</span>(<span class="hljs-params"> content </span>) </span>{ <span class="hljs-comment">// For [glossary_(term_list|atoz)]</span>
				<span class="hljs-keyword">return</span> content.replace( <span class="hljs-regexp">/&lt;span\s+(?=[^&gt;]*data-type="ithoughts-tooltip-glossary-(term_list|atoz)")(.*?)&gt;.*?&lt;\/span&gt;/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doReplace</span>(<span class="hljs-params"> all, type, attrStr </span>) </span>{
					<span class="hljs-keyword">var</span> attrs	= {},
						regex	= <span class="hljs-regexp">/(data-)?([\w\d\-]+?)="(.+?)"/g</span>,
						matched	= <span class="hljs-literal">null</span>,
						ret		= <span class="hljs-string">`[glossary_<span class="hljs-subst">${  type }</span>`</span>,
						i;
					<span class="hljs-keyword">while</span> ( <span class="hljs-literal">true</span> === <span class="hljs-built_in">Boolean</span>( matched = regex.exec( attrStr ))) {
						<span class="hljs-keyword">if</span> ( matched[<span class="hljs-number">1</span>] !== <span class="hljs-string">'data-'</span> || matched[<span class="hljs-number">2</span>] !== <span class="hljs-string">'type'</span> ) {
							<span class="hljs-keyword">if</span> ( htmlAttrs.indexOf( i ) &gt; <span class="hljs-number">-1</span> &amp;&amp; <span class="hljs-keyword">typeof</span> matched[<span class="hljs-number">1</span>] !== <span class="hljs-string">'undefined'</span> ) {
								attrs[matched[<span class="hljs-number">1</span>] + matched[<span class="hljs-number">2</span>]] = matched[<span class="hljs-number">3</span>];
							} <span class="hljs-keyword">else</span> {
								attrs[matched[<span class="hljs-number">2</span>]] = matched[<span class="hljs-number">3</span>];
							}
						}
					}
					<span class="hljs-keyword">for</span> ( i <span class="hljs-keyword">in</span> attrs ) {
						<span class="hljs-keyword">if</span> ( attrs.hasOwnProperty( i )) {
							ret += <span class="hljs-string">` <span class="hljs-subst">${  i  }</span>="<span class="hljs-subst">${  attrs[i]  }</span>"`</span>;
						}
					}
					<span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${ ret  }</span>/]`</span>;
				});
			},
		];

		itge.editorForms = {
			<span class="hljs-attr">list</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">list</span>(<span class="hljs-params"> selection, callback </span>) </span>{
				itge.log( <span class="hljs-string">'Selection infos to load TIP: '</span>, selection );
				<span class="hljs-keyword">var</span> mode = <span class="hljs-string">'insert_content'</span>,
					node	= selection.start,
					values = {
						<span class="hljs-attr">type</span>:  <span class="hljs-string">'atoz'</span>,
						<span class="hljs-attr">alpha</span>: [],
						<span class="hljs-attr">group</span>: [],
					},
					loader;
				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trimFilter</span>(<span class="hljs-params"> attrsStr </span>) </span>{
					<span class="hljs-keyword">return</span> ( attrsStr||<span class="hljs-string">''</span> ).split( <span class="hljs-string">','</span> ).map( <span class="hljs-built_in">Function</span>.prototype.call, <span class="hljs-built_in">String</span>.prototype.trim ).filter( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterNonNullAttr</span>(<span class="hljs-params"> e </span>) </span>{
						<span class="hljs-keyword">return</span> e;
					});
				}
				<span class="hljs-keyword">if</span> ( !isNA( selection.start ) &amp;&amp; selection.start === selection.end ) {
					itge.log( <span class="hljs-string">`Start &amp; End node are the same, operating on a node of type <span class="hljs-subst">${  node.nodeName }</span>`</span> );
					<span class="hljs-keyword">if</span> ( node &amp;&amp; node.nodeName !== <span class="hljs-string">'#text'</span> ) {
						$.extend( values, {
							<span class="hljs-attr">alpha</span>: trimFilter( node.getAttribute( <span class="hljs-string">'data-alpha'</span> )),
							<span class="hljs-attr">group</span>: trimFilter( node.getAttribute( <span class="hljs-string">'data-group'</span> )),
						});
						<span class="hljs-keyword">if</span> ( <span class="hljs-string">'ithoughts-tooltip-glossary-atoz'</span> === node.getAttribute( <span class="hljs-string">'data-type'</span> )) { <span class="hljs-comment">// Is atoz</span>
							mode = <span class="hljs-string">'load'</span>;
							values.type = <span class="hljs-string">'atoz'</span>;
						} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-string">'ithoughts-tooltip-glossary-term_list'</span> === node.getAttribute( <span class="hljs-string">'data-type'</span> )) { <span class="hljs-comment">// Is term_list</span>
							mode = <span class="hljs-string">'load'</span>;
							values.type = <span class="hljs-string">'list'</span>;
							$.extend( values, {
								<span class="hljs-attr">cols</span>: <span class="hljs-built_in">parseInt</span>( node.getAttribute( <span class="hljs-string">'data-cols'</span> )),
								<span class="hljs-attr">desc</span>: node.getAttribute( <span class="hljs-string">'data-desc'</span> ),
							});
						}
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Then generate form through Ajax</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				loader = ithoughts.makeLoader();
				$.ajax({
					<span class="hljs-attr">method</span>:	<span class="hljs-string">'POST'</span>,
					<span class="hljs-attr">async</span>:  <span class="hljs-literal">true</span>,
					<span class="hljs-attr">url</span>:    itge.admin_ajax,
					<span class="hljs-attr">data</span>:   {
						<span class="hljs-attr">action</span>: <span class="hljs-string">'ithoughts_tt_gl_get_tinymce_list_form'</span>,
						<span class="hljs-attr">data</span>:   values,
					},
					<span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">success</span>(<span class="hljs-params"> out </span>) </span>{
						loader.remove();
						<span class="hljs-keyword">var</span> newDom = $( $.parseHTML( out, <span class="hljs-literal">true</span> ));

						$( <span class="hljs-built_in">document</span>.body ).append( newDom.css({
							<span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>,
						}).animate({
							<span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,
						}, <span class="hljs-number">500</span> ));


						itge.finishListTinymce = ( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">finishListTinymce</span>(<span class="hljs-params"></span>) </span>{
							<span class="hljs-keyword">var</span> domC = newDom;
							<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleFormSubmitted</span>(<span class="hljs-params"> data </span>) </span>{
								itge.info( <span class="hljs-string">'New list data:'</span>, data );
								domC.animate({
									<span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>,
								}, <span class="hljs-number">500</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateEnd</span>(<span class="hljs-params"></span>) </span>{
									domC.remove();
								});
								<span class="hljs-keyword">if</span> ( <span class="hljs-string">'undefined'</span> === <span class="hljs-keyword">typeof</span> data ) {
									<span class="hljs-keyword">return</span>;
								}

								<span class="hljs-keyword">var</span> shortcode = <span class="hljs-string">`glossary_<span class="hljs-subst">${  ({
										atoz: <span class="hljs-string">'atoz'</span>,
										list: <span class="hljs-string">'term_list'</span>,
									}</span>)[data.type] }`</span>,
									tail = ( mode !== <span class="hljs-string">'load'</span> ) ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>,
									optsStrs		= [],
									addOpt			= <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addOpt</span>(<span class="hljs-params"> label, value, specEncode </span>) </span>{
										optsStrs.push( generateAttr( label, value, specEncode ));
										optsStrs = optsStrs.filter( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterNoNA</span>(<span class="hljs-params"> val </span>) </span>{
											<span class="hljs-keyword">return</span> !isNA( val );
										});
									};


								<span class="hljs-keyword">var</span> attrs = [ <span class="hljs-string">'alpha'</span>, <span class="hljs-string">'group'</span> ];
								<span class="hljs-keyword">switch</span> ( data.type ) {
									<span class="hljs-keyword">case</span> <span class="hljs-string">'list'</span>: {
										attrs = attrs.concat([ <span class="hljs-string">'cols'</span>, <span class="hljs-string">'desc'</span> ]);
									} <span class="hljs-keyword">break</span>;
												   }

								<span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, I = attrs.length; i &lt; I; i++ ) {
									<span class="hljs-keyword">var</span> attr = attrs[i];
									<span class="hljs-keyword">if</span> ( data.hasOwnProperty( attr )) {
										addOpt( attr, data[attr]);
									}
								}

								<span class="hljs-keyword">var</span> finalContent = <span class="hljs-string">`[<span class="hljs-subst">${  shortcode  }</span> <span class="hljs-subst">${  optsStrs.join( <span class="hljs-string">' '</span> )  }</span>/]<span class="hljs-subst">${  tail }</span>`</span>;
								itge.log( <span class="hljs-string">'Final content:'</span>, finalContent );
								<span class="hljs-keyword">return</span> callback( finalContent, mode );
							};
						}());
					},
					<span class="hljs-attr">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params"></span>) </span>{
						loader.remove();
						itge.error( <span class="hljs-string">'Error while getting TinyMCE form for Tip: '</span>, <span class="hljs-built_in">arguments</span> );
					},
				});
			},
			<span class="hljs-attr">tip</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tip</span>(<span class="hljs-params"> selection, callback, escapeContent </span>) </span>{
				itge.info( <span class="hljs-string">'Selection infos to load TIP: '</span>, selection );
				<span class="hljs-keyword">var</span> values	= {},
					node	= selection.start,
					mode	= <span class="hljs-string">''</span>,
					i		= <span class="hljs-number">-1</span>,
					content,
					atts,
					attsLength,
					attrs,
					att,
					takeAttr,
					positionAt,
					positionMy,
					myInverted,
					tristate,
					loader;
				<span class="hljs-keyword">if</span> ( !isNA( selection.start ) &amp;&amp; selection.start === selection.end ) {
					itge.log( <span class="hljs-string">`Start &amp; End node are the same, operating on a node of type <span class="hljs-subst">${  node.nodeName }</span>`</span> );
					content = ( node &amp;&amp; node.text ) || selection.html; <span class="hljs-comment">// Get node text if any or get selection</span>
					itge.log( <span class="hljs-string">'Loading content: '</span>, content );
					<span class="hljs-keyword">if</span> ( node &amp;&amp; node.nodeName !== <span class="hljs-string">'#text'</span> &amp;&amp; tipsTypes.indexOf( node.getAttribute( <span class="hljs-string">'data-type'</span> )) &gt; <span class="hljs-number">-1</span> ) { <span class="hljs-comment">// On Glossary Term or Tooltip or Mediatip, load data</span>
						mode = <span class="hljs-string">'load'</span>;
						attrs = {};
						atts = node.attributes;
						attsLength = atts.length;
						<span class="hljs-keyword">while</span> (( i += <span class="hljs-number">1</span> ) &lt; attsLength ) {
							att = atts[i];
							attrs[att.nodeName] = att.nodeValue;
						}
						takeAttr = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">takeAttr</span>(<span class="hljs-params"> label, nodata </span>) </span>{
							<span class="hljs-keyword">if</span> ( isNA( nodata ) || !nodata ) {
								label = <span class="hljs-string">`data-<span class="hljs-subst">${  label }</span>`</span>;
							}
							<span class="hljs-keyword">var</span> val = attrs[label];
							<span class="hljs-keyword">delete</span> attrs[label];
							<span class="hljs-keyword">return</span> val;
						};


						positionAt = ( takeAttr( <span class="hljs-string">'position-at'</span> ) || <span class="hljs-string">' '</span> ).split( <span class="hljs-string">' '</span> );
						positionMy = ( takeAttr( <span class="hljs-string">'position-my'</span> ) || <span class="hljs-string">' '</span> ).split( <span class="hljs-string">' '</span> );
						myInverted = ( <span class="hljs-number">1</span> === <span class="hljs-built_in">Math</span>.max( positionMy.indexOf( <span class="hljs-string">'top'</span> ), positionMy.indexOf( <span class="hljs-string">'bottom'</span> ))) || ( <span class="hljs-number">0</span> === <span class="hljs-built_in">Math</span>.max( positionMy.indexOf( <span class="hljs-string">'right'</span> ), positionMy.indexOf( <span class="hljs-string">'left'</span> )));
						positionAt = {
							<span class="hljs-number">1</span>: positionAt[<span class="hljs-number">0</span>],
							<span class="hljs-number">2</span>: positionAt[<span class="hljs-number">1</span>],
						};
						positionMy = {
							<span class="hljs-number">1</span>:      positionMy[myInverted ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>],
							<span class="hljs-number">2</span>:      positionMy[myInverted ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>],
							<span class="hljs-attr">invert</span>: myInverted ? <span class="hljs-string">'enabled'</span> : <span class="hljs-literal">undefined</span>,
						};

						tristate = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tristate</span>(<span class="hljs-params"> val </span>) </span>{
							<span class="hljs-keyword">if</span> ( <span class="hljs-string">'true'</span> === val ) {
								<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
							}
							<span class="hljs-keyword">if</span> ( <span class="hljs-string">'false'</span> === val ) {
								<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
							}
							<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
						};

						<span class="hljs-keyword">var</span> tooltipContent = takeAttr( <span class="hljs-string">'tooltip-content'</span> );
						<span class="hljs-keyword">if</span> ( escapeContent &amp;&amp; tooltipContent ) {
							tooltipContent = tooltipContent.replace( <span class="hljs-regexp">/&amp;lt;/g</span>, <span class="hljs-string">'&lt;'</span> ).replace( <span class="hljs-regexp">/&amp;gt;/g</span>, <span class="hljs-string">'&gt;'</span> );
						}

						values = {
							<span class="hljs-attr">text</span>:             content,
							<span class="hljs-attr">link</span>:             takeAttr( <span class="hljs-string">'href'</span>, <span class="hljs-literal">true</span> ),
							<span class="hljs-attr">tooltip_content</span>:  stripQuotes( tooltipContent || content, <span class="hljs-literal">false</span> ),
							<span class="hljs-attr">glossary_id</span>:      takeAttr( <span class="hljs-string">'glossary-id'</span> ),
							<span class="hljs-attr">term_search</span>:      itge.removeAccents( content.toLowerCase()),
							<span class="hljs-attr">mediatip_type</span>:    takeAttr( <span class="hljs-string">'mediatip-type'</span> ),
							<span class="hljs-attr">mediatip_content</span>: stripQuotes( takeAttr( <span class="hljs-string">'mediatip-content'</span> ), <span class="hljs-literal">false</span> ),
							<span class="hljs-attr">mediatip_link</span>:    takeAttr( <span class="hljs-string">'mediatip-link'</span> ),
							<span class="hljs-attr">mediatip_caption</span>: takeAttr( <span class="hljs-string">'mediatip-caption'</span> ),
							<span class="hljs-attr">type</span>:             [ <span class="hljs-string">'glossary'</span>, <span class="hljs-string">'tooltip'</span>, <span class="hljs-string">'mediatip'</span> ][tipsTypes.indexOf( takeAttr( <span class="hljs-string">'type'</span> ))],
							<span class="hljs-attr">opts</span>:             {
								<span class="hljs-attr">termcontent</span>:      takeAttr( <span class="hljs-string">'termcontent'</span> ),
								<span class="hljs-string">'qtip-keep-open'</span>: <span class="hljs-string">'true'</span> === takeAttr( <span class="hljs-string">'qtip-keep-open'</span> ),
								<span class="hljs-attr">qtiprounded</span>:      tristate( takeAttr( <span class="hljs-string">'qtiprounded'</span> )),
								<span class="hljs-attr">qtipshadow</span>:       tristate( takeAttr( <span class="hljs-string">'qtipshadow'</span> )),
								<span class="hljs-attr">qtipstyle</span>:        takeAttr( <span class="hljs-string">'qtipstyle'</span> ),
								<span class="hljs-attr">qtiptrigger</span>:      takeAttr( <span class="hljs-string">'qtiptrigger'</span> ),
								<span class="hljs-attr">position</span>:         {
									<span class="hljs-attr">at</span>:	positionAt,
									<span class="hljs-attr">my</span>:	positionMy,
								},
								<span class="hljs-attr">attributes</span>:	{
									<span class="hljs-attr">span</span>: {},
									<span class="hljs-attr">link</span>:	{},
								},
								<span class="hljs-attr">anim</span>: {
									<span class="hljs-attr">in</span>:   takeAttr( <span class="hljs-string">'animation_in'</span> ),
									<span class="hljs-attr">out</span>:  takeAttr( <span class="hljs-string">'animation_out'</span> ),
									<span class="hljs-attr">time</span>: takeAttr( <span class="hljs-string">'animation_time'</span> ),
								},
								<span class="hljs-attr">maxwidth</span>: takeAttr( <span class="hljs-string">'tooltip-maxwidth'</span> ),
							},

							<span class="hljs-attr">glossary_disable_auto_translation</span>: <span class="hljs-string">'true'</span> === ( takeAttr( <span class="hljs-string">'disable_auto_translation'</span> ) || <span class="hljs-literal">false</span> ),
						};
						<span class="hljs-keyword">for</span> ( i <span class="hljs-keyword">in</span> attrs ) {
							<span class="hljs-keyword">if</span> ( attrs.hasOwnProperty( i )) {
								<span class="hljs-keyword">if</span> ( i.match( <span class="hljs-regexp">/^data-link-/</span> )) {
									values.opts.attributes.link[i.replace( <span class="hljs-regexp">/^data-link-(data-)?/</span>, <span class="hljs-string">''</span> )] = attrs[i];
								} <span class="hljs-keyword">else</span> {
									values.opts.attributes.span[i.replace( <span class="hljs-regexp">/^data-/</span>, <span class="hljs-string">''</span> )] = attrs[i];
								}
							}
						}
					} <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Create new glossary term</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						values	= {
							<span class="hljs-attr">text</span>:             <span class="hljs-string">''</span>,
							<span class="hljs-attr">link</span>:             <span class="hljs-string">''</span>,
							<span class="hljs-attr">tooltip_content</span>:  <span class="hljs-string">''</span>,
							<span class="hljs-attr">glossary_id</span>:      <span class="hljs-literal">null</span>,
							<span class="hljs-attr">term_search</span>:      <span class="hljs-string">''</span>,
							<span class="hljs-attr">mediatip_type</span>:    <span class="hljs-string">''</span>,
							<span class="hljs-attr">mediatip_content</span>: <span class="hljs-string">''</span>,
							<span class="hljs-attr">mediatip_caption</span>: <span class="hljs-string">''</span>,
							<span class="hljs-attr">type</span>:             <span class="hljs-string">'tooltip'</span>,

							<span class="hljs-attr">glossary_disable_auto_translation</span>:	<span class="hljs-literal">false</span>,
						};</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>If something is selected, load the content as text, content for tooltip &amp; search</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> ( content &amp;&amp; content.length &gt; <span class="hljs-number">0</span> ) {
							mode	= <span class="hljs-string">'replace_content'</span>;
							values	= $.extend( values, {
								<span class="hljs-attr">text</span>:            content,
								<span class="hljs-attr">tooltip_content</span>: content,
								<span class="hljs-attr">term_search</span>:     itge.removeAccents( content.toLowerCase()),
							});
						} <span class="hljs-keyword">else</span> {
							mode	= <span class="hljs-string">'add_content'</span>;
						}
					}
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Then generate form through Ajax</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				loader = ithoughts.makeLoader();
				$.ajax({
					<span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
					<span class="hljs-attr">async</span>:  <span class="hljs-literal">true</span>,
					<span class="hljs-attr">url</span>:    itge.admin_ajax,
					<span class="hljs-attr">data</span>:   {
						<span class="hljs-attr">action</span>:	  <span class="hljs-string">'ithoughts_tt_gl_get_tinymce_tooltip_form'</span>,
						<span class="hljs-attr">data</span>:     values,
						<span class="hljs-attr">_wpnonce</span>: itge.nonce,
					},
					<span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">success</span>(<span class="hljs-params"> out </span>) </span>{
						loader.remove();
						<span class="hljs-keyword">var</span> newDom = $( $.parseHTML( out, <span class="hljs-literal">true</span> ));
						$( <span class="hljs-built_in">document</span>.body ).append( newDom.css({
							<span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,
						}).animate({
							<span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,
						}, <span class="hljs-number">500</span> ));


						itge.finishTipTinymce = ( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">finishTipTinymce</span>(<span class="hljs-params"></span>) </span>{
							<span class="hljs-keyword">var</span> domC = newDom;
							<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleFormSubmitted</span>(<span class="hljs-params"> data </span>) </span>{
								itge.info( <span class="hljs-string">'New tooltip data:'</span>, data );
								domC.animate({
									<span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>,
								}, <span class="hljs-number">500</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateAfter</span>(<span class="hljs-params"></span>) </span>{
									domC.remove();
								});
								<span class="hljs-keyword">if</span> ( <span class="hljs-string">'undefined'</span> === <span class="hljs-keyword">typeof</span> data || <span class="hljs-literal">null</span> === data ) {
									<span class="hljs-keyword">return</span>;
								}
								<span class="hljs-keyword">var</span> optsStrs		= [],
									attributesList	= domC.find( <span class="hljs-string">'#attributes-list option'</span> ).map( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">domToValue</span>(<span class="hljs-params"></span>) </span>{
										<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;
									}).toArray(),
									opts			= data.opts || values.opts,
									addOpt			= <span class="hljs-function">(<span class="hljs-params"> label, value, specEncode </span>) =&gt;</span> {
										optsStrs.push( generateAttr( label, value, specEncode ));
										optsStrs = optsStrs.filter( <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterNoNA</span>(<span class="hljs-params"> val </span>) </span>{
											<span class="hljs-keyword">return</span> !isNA( val );
										});
									},
									my,
									types			= [ <span class="hljs-string">'span'</span>, <span class="hljs-string">'link'</span> ],
									typesLength		= types.length,
									i				= <span class="hljs-number">-1</span>,
									j,
									prefix,
									midPart,
									optsAttrs		= ( opts &amp;&amp; opts.attributes ) || {},
									shortcode		= <span class="hljs-string">`<span class="hljs-subst">${ prefix4  }</span>-<span class="hljs-subst">${  data.type }</span>`</span>,
									tail			= ( mode !== <span class="hljs-string">'load'</span> &amp;&amp; <span class="hljs-number">0</span> === content.length ) ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>;

								<span class="hljs-keyword">if</span> ( !isNA( opts )) {
									<span class="hljs-keyword">if</span> ( opts[<span class="hljs-string">'qtip-content'</span>]) {
										addOpt( <span class="hljs-string">'data-termcontent'</span>, opts[<span class="hljs-string">'qtip-content'</span>]);
									}
									<span class="hljs-keyword">if</span> ( opts[<span class="hljs-string">'qtip-keep-open'</span>]) {
										addOpt( <span class="hljs-string">'data-qtip-keep-open'</span>, <span class="hljs-string">'true'</span> );
									}
									<span class="hljs-keyword">if</span> ( !isNA( opts.qtiprounded )) {
										addOpt( <span class="hljs-string">'data-qtiprounded'</span>, <span class="hljs-built_in">String</span>( opts.qtiprounded ));
									}
									<span class="hljs-keyword">if</span> ( !isNA( opts.qtipshadow )) {
										addOpt( <span class="hljs-string">'data-qtipshadow'</span>, <span class="hljs-built_in">String</span>( opts.qtipshadow ));
									}
									<span class="hljs-keyword">if</span> ( opts.qtipstyle ) {
										addOpt( <span class="hljs-string">'data-qtipstyle'</span>, opts.qtipstyle );
									}
									<span class="hljs-keyword">if</span> ( opts.qtiptrigger ) {
										addOpt( <span class="hljs-string">'data-qtiptrigger'</span>, opts.qtiptrigger );
									}
									<span class="hljs-keyword">if</span> ( opts.position ) {
										<span class="hljs-keyword">if</span> ( opts.position.at &amp;&amp; opts.position.at[<span class="hljs-number">1</span>] &amp;&amp; opts.position.at[<span class="hljs-number">2</span>]) {
											addOpt( <span class="hljs-string">'data-position-at'</span>, <span class="hljs-string">`<span class="hljs-subst">${ opts.position.at[<span class="hljs-number">1</span>]  }</span> <span class="hljs-subst">${  opts.position.at[<span class="hljs-number">2</span>] }</span>`</span> );
										}
										<span class="hljs-keyword">if</span> ( opts.position.my &amp;&amp; opts.position.my[<span class="hljs-number">1</span>] &amp;&amp; opts.position.my[<span class="hljs-number">2</span>]) {
											my = [ opts.position.my[<span class="hljs-number">1</span>], opts.position.my[<span class="hljs-number">2</span>] ];
											<span class="hljs-keyword">if</span> ( opts.position.my.invert ) {
												my.reverse();
											}
											addOpt( <span class="hljs-string">'data-position-my'</span>, my.join( <span class="hljs-string">' '</span> ));
										}
									}
									<span class="hljs-keyword">if</span> ( opts.anim ) {
										<span class="hljs-keyword">if</span> ( opts.anim[<span class="hljs-string">'in'</span>]) {
											addOpt( <span class="hljs-string">'data-animation_in'</span>, opts.anim[<span class="hljs-string">'in'</span>]);
										}
										<span class="hljs-keyword">if</span> ( opts.anim.out ) {
											addOpt( <span class="hljs-string">'data-animation_out'</span>, opts.anim.out );
										}
										<span class="hljs-keyword">if</span> ( opts.anim.time ) {
											addOpt( <span class="hljs-string">'data-animation_time'</span>, opts.anim.time );
										}
									}
									<span class="hljs-keyword">if</span> ( opts.maxwidth ) {
										addOpt( <span class="hljs-string">'data-tooltip-maxwidth'</span>, opts.maxwidth );
									}
									<span class="hljs-keyword">while</span> ( i++ <span class="xml"><span class="hljs-tag">&lt; <span class="hljs-attr">typesLength</span> ) {
										<span class="hljs-attr">var</span> <span class="hljs-attr">type</span> = <span class="hljs-string">types[i];</span>
										<span class="hljs-attr">if</span> ( <span class="hljs-attr">optsAttrs.hasOwnProperty</span>( <span class="hljs-attr">type</span> )) {
											<span class="hljs-attr">for</span> ( <span class="hljs-attr">j</span> <span class="hljs-attr">in</span> <span class="hljs-attr">optsAttrs</span>[<span class="hljs-attr">type</span>]) {
												<span class="hljs-attr">if</span> ( <span class="hljs-attr">optsAttrs</span>[<span class="hljs-attr">type</span>]<span class="hljs-attr">.hasOwnProperty</span>( <span class="hljs-attr">j</span> )) {
													<span class="hljs-attr">prefix</span> = <span class="hljs-string">attributesList.indexOf(</span> <span class="hljs-attr">j</span> ) &gt;</span> -1 &amp;&amp; !j.startsWith( 'data-' ) ? '' : 'data-';
													midPart = 'link' === type ? 'link-' : '';
													addOpt( prefix + midPart + j, optsAttrs[type][j], true );
												}
											}
										}
									}
								}
								if ( data.link ) {
									addOpt( 'href', encodeURI( data.link ));
								}

								if ( 'glossary' === data.type ) {
									if ( !data.glossary_id || !data.text ) {
										return;
									} else {
										addOpt( 'glossary-id', data.glossary_id );
										if ( data.disable_auto_translation ) {
											addOpt( 'disable_auto_translation', 'true' );
										}
									}
								} else if ( 'tooltip' === data.type ) {
									if ( !data.tooltip_content || !data.text ) {
										return;
									} else {
										addOpt( 'tooltip-content', escapeContent ? data.tooltip_content.replace( /<span class="hljs-tag">&lt;/<span class="hljs-name">g,</span> '&amp;<span class="hljs-attr">lt</span>;' )<span class="hljs-attr">.replace</span>( /&gt;</span>/g, '&amp;gt;' ) : data.tooltip_content, true );
									}
								} else if ( 'mediatip' === data.type ) {
									if ( !data.mediatip_type || !data.mediatip_content || !data.text ) {
										return;
									} else {
										addOpt( 'mediatip-type', data.mediatip_type );
										addOpt( 'mediatip-content', data.mediatip_content, true );
										if ( data.mediatip_caption ) {
											addOpt( 'mediatip-caption', data.mediatip_caption, true );
										}
									}
								}
								var finalContent = `[${  shortcode  } ${  optsStrs.join( ' ' )  }]${  data.text  }[/${  shortcode  }]${  tail }`;
								itge.log( 'Final content:', finalContent );
								return callback( finalContent, mode );
							};
						}());
					},
					error: function error() {
						loader.remove();
						itge.error( 'Error while getting TinyMCE form for Tip: ', arguments );
					},
				});
			},
		};

		function generateSelObject() {
			var txtarea = $( '#content' ).get( 0 );
			var sel = {
				html: itge.replaceShortcodes( txtarea.value.substring( txtarea.selectionStart, txtarea.selectionEnd )),
			};
			sel.DOM = $.parseHTML( sel.html );
			sel.start = $( sel.DOM ).first().get( 0 );
			sel.end = $( sel.DOM ).last().get( 0 );
			return sel;
		}
		function generateAttr( label, value, specEncode ) {
			value = String( value ).trim();
			if ( !label.match( /^[\w_\-]*$/ )) {
				return null;
			}
			return `${ stripQuotes( label.trim(), true )  }="${   !isNA( specEncode ) &amp;&amp; specEncode ? value.replace( /"/g, '&amp;aquot;' ).replace( /\n/g, '<span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>' ) : stripQuotes( value, true )  }"`;
		}
		QTags.addButton( 'ithoughts_tt_gl-tip', 'ITG Tip', function onClickButton() {
			itge.editorForms.tip( generateSelObject(), QTags.insertContent, true );
		});
		QTags.addButton( 'ithoughts_tt_gl-list', 'ITG List', function onClickButton() {
			itge.editorForms.list( generateSelObject(), QTags.insertContent, true );
		});
	});
})( iThoughts.v5 );

</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
